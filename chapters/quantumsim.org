# Intro (what is quantumsim, advantages)

Quantumsim cite:O_Brien_2017 is a simulator of superconducting systems designed to study the SC-7 and SC-17 chips and based on their behaviour on experiments.
It performs calculations on *density matrices* instead of the compact representation of the quantum states because they permit the use of mixed states -- able to represent any kind of errors.
As it can be inherited in the [[id:68e8f11a-edd9-4e09-a99e-5ef841f010f7][Qubits]] subsection, the density matrix size grows exponentially with the number of qubits it represents -- $2^n \times 2^n$ where $n$ is the number of qubits.
Once the qubits state is ready as a density matrix, quantumsim applies the quantum gates in the *Pauli transfer matrix representation*.
The Pauli representation builds positive matrices that preserves the trace properties of the original matrix -- Completely Positive Trace-Preserving (CPTP) transformation -- cite:Merkel_2013 to represent the gates.
In order to avoid non-efficient calculations, in place of building a huge density matrix considering all the qubits from the very beginning, quantumsim will enlarge dynamically the density matrix whenever a gate requires a new qubit.
As this calculations are computationally hard, quantumsim has the possibility of boosting calculations with a Graphics Processing Unit (GPU).


# In the quantumsim module, all gates are applied in the Pauli transfer matrix representation:

#+NAME: eq:pauli_representation
\begin{equation}
(R_{\Lambda})_{ij} = \frac{1}{2} Tr(\sigma_i \Lambda \sigma_j)
\end{equation}

where $\Lambda$ is the CPTP transformation and $\sigma_i$ are the Pauli operators, viz. $\sigma_0 = I$, $\sigma_1 = X$, $\sigma_2 = Y$, $\sigma_3 = Z$, equivalent to rotations around the main axes of the Bloch sphere.

# One-qubit and two- qubit gates are applied to the density matrix as completely positive, trace preserving maps represented by Pauli transfer matrices. When a gate involving a << new >> qubit must be performed, the density matrix of the system is dynamically enlarged to include that one [...]




**** Error model

Quantumsim considers six main error sources in the SC-7 and SC-17, of which three comes from the different operations -- single/two-qubit gates and measurement -- and the others are either decoherence or apparatus related errors -- photon decay and the flux noise.
Each operation has its own model, based on the learning extracted from several experiments.
The same happens to the other studied phenomena that are incorporated in different ways in the gate matrices.
In this section we will describe the error sources and how they are simulated in quantumsim.
From decoherence to the apparatus related errors -- that affect the gates error.
Also, Tab. [[tab:err_pam]] pinpoints exactly the value of the parameters used in the error model.


***** Qubit Idling

While idling for a time $t$, a transmon in $|1\rangle$ or in superposition could relax to $|0\rangle$ or acquire random quantum phase shifts due to $1/f$ noise sources (flux noise) or others.
The dephasing effect only appears in a superposition state.

****** Amplitude-phase damping model                            :ignore:

#+NAME: eq:dephase_t1
\begin{equation}
R_{\Lambda_{T_1}} = \begin{bmatrix}
 1 & 0 & 0 & 0 \\
 0 & \sqrt{1 - p_1} & 0 & 0 \\
 0 & 0 & \sqrt{1 - p_1} & 0 \\
 p_1 & 0 & 0 & 1 - p_1 \\
\end{bmatrix}
\end{equation}

# #+ATTR_LATEX: :mode math :environment bmatrix
# |   1 |              0 |              0 |       0 |
# |   0 | \sqrt{1 - p_1} |              0 |       0 |
# |   0 |              0 | \sqrt{1 - p_1} |       0 |
# | p_1 |              0 |              0 | 1 - p_1 |

#+NAME: eq:dephase_t2
\begin{equation}
R_{\Lambda_{T_{\phi}}} = \begin{bmatrix}
 1 & 0 & 0 & 0 \\
 0 & \sqrt{1 - p_{\phi}} & 0 & 0 \\
 0 & 0 & \sqrt{1 - p_{\phi}} & 0 \\
 0 & 0 & 0 & 1 \\
\end{bmatrix}
\end{equation}

# #+ATTR_LATEX: :mode math :environment bmatrix
# | 1 |                   0 |                   0 | 0 |
# | 0 | \sqrt{1 - p_{\phi}} |                   0 | 0 |
# | 0 |                   0 | \sqrt{1 - p_{\phi}} | 0 |
# | 0 |                   0 |                   0 | 1 |

with $p_1 = 1 - e^{-\frac{t}{T_1}}$ and $p_{\phi} = 1 - e^{-\frac{t}{T_{\phi}}}$ that are the probabilities for relaxation and pure dephasing, respectively.

****** Qubit idling                                             :ignore:

Idling for a duration $t$:

#+NAME: eq:idling
\begin{equation}
R_{AP (t)} = R_{\Lambda_{T_1}} R_{\Lambda_{T_{\phi}}}
\end{equation}

***** Photon decay
:PROPERTIES:
:ID:       07599b1a-0150-4e80-ad59-8ce826f8d96a
:END:

While measuring a qubit state under the presence of photons in a readout resonator, the coupled qubit is affected suffering a $p_{\phi, photon}$ dephasing.
This dephasing is present whenever the coupled qubit is brought into superposition before the readout resonator has returned to the vacuum state following the last measurement.
This dephasing is then implemented via the same Pauli transfer matrix as $R_{\Lambda_{T_{\phi}}}$ in eq. [[eq:idling]].

***** Flux Noise

Whenever a two-qubit operation is done, qubits are moved in frequency away to their sweet spot ($f_{q,max}$) with flux pulses as it was seen in the [[id:5fc58a48-9874-45ed-94ff-095153aeea0f][Constraints of the Surface-7 and -17 chips]] section.
And the only affected qubits are not the targeted ones, but also the NN that need to avoid the effects of the operation.
While outside their sweet spot, the qubits are highly affected by the noise inserted by the flux pulses.
This noise causes a random phase shift in the qubit state.
As soon as the power spectrum of the flux noise is $1/f$ -- main contribution is related with low-frequencies --, adjusting the qubit frequency to a lower frequency makes the qubit even more sensitive to it.

***** Single-qubit $R_y(\pi /2)$ rotations

Quantumsim models single-qubit gates adding idle matrices of duration $\frac{\tau_{g,1Q}}{2}$ before and after the CPTP gate representation, allowing the insertion of amplitude and phase damping ($T_1$ and $T_{\phi}$)).
The addition of this error is equivalent to shrinking a quantum state towards the origin.
Quantumsim considers this shrinking with a factor of $1 - p_{axis}$ along the y-axis and $1 - p_{plane}$ along the x- and z-axes as it is described in eq. [[eq:single_q_error]].

#+NAME: eq:single_q_error
\begin{equation}
R_{R_y (\pi /2)} = R_{AP (\frac{\tau_{g,1Q}}{2})} R_{R_y (\pi /2)}' R_{dep} R_{AP (\frac{\tau_{g,1Q}}{2})}
\end{equation}

where

$$R_{dep} = \begin{bmatrix}
 1 & 0 & 0 & 0 \\
 0 & 1 - p_{plane} & 0 & 0 \\
 0 & 0 & 1 - p_{axis} & 0 \\
 0 & 0 & 0 & 1 - p_{plane} \\
\end{bmatrix}$$

# #+ATTR_LATEX: :mode math :environment bmatrix
# | 1 |             0 |            0 |             0 |
# | 0 | 1 - p_{plane} |            0 |             0 |
# | 0 |             0 | 1 - p_{axis} |             0 |
# | 0 |             0 |            0 | 1 - p_{plane} |

and $R_{R_y (\pi/2)}'$ is the Pauli transfer matrix describing the theoretical $\pi /2$ rotation along the y axis.
# This procedure could be done with whatever Pauli transfer matrix.
# The y rotation is just the most common example.

***** CZ gates

As it was described in the [[id:5fc58a48-9874-45ed-94ff-095153aeea0f][Constraints of the Surface-7 and -17 chips]] section, a CZ gate is executed flu pulsing the frequency of the qubits in to a frequency in the middle of their sweet spots.
That make both qubit states interact with each other in a CZ gate fashion, holding the qubits for a $\tau_{g,2Q}$ period of time.
Quantumsim's model of the CZ gate consists of a CZ representation adding the single-qubit phase error $\delta_{\phi_{1Q}}$ as well as the two-qubit phase error $\delta_{\phi_{2Q}} = \frac{\delta_{\phi_{1Q}}}{2}$.
It will be also surrounded by idling intervals of duration $\frac{\tau_{g,2Q}}{2}$.
Quantumsim neglects leakage during the two-qubit gates because previous experiments have reduced leakage probability per CZ to $\approx$ 0.3%.

***** Measurement

The behaviour of the measurements in the simulations follow the Born rule cite:O_Brien_2017, giving projection probabilities calculated based on the quantum state probabilities.
The measurements are implemented as black-boxes surrounded by idling steps (as the other quantum gates).
The black-box consists of a dephasing -- due to the photon decay phenomena -- followed by a period of decay and excitation with probability $p_{\uparrow / \downarrow}^{(1)}$.
After that, the qubit state is collapsed with an error probability $\epsilon_{RO}$ and, then, the qubit state is subject to further decay or excitation with probabilities $p_{\uparrow / \downarrow}^{(2)}$.
Finally, after measuring, quantumsim removes that qubit out of the main density matrix.
Quantumsim ignore effects leading to measurement-induced mixing and non-linearity of the readout resonator, as well as residual photon numbers.

#+caption: Black box model from cite:O_Brien_2017
#+NAME: fig:meas_model
#+ATTR_LATEX: :width 0.5\textwidth
[[file:figures/measure_model.png]]



#+caption: Main error model parameters for simulation cite:O_Brien_2017
#+NAME: tab:err_pam
#+ATTR_LATEX: :booktabs :environment :font \tiny :align lccp{7cm}
|------------------------------------+--------------------------+------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Parameter                          | Symbol                   | Value      | Explanation and notes                                                                                                                                            |
|------------------------------------+--------------------------+------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Qubit relaxation time              | $T_1$                    | 30 $\mu s$ | Only affects qubits in the excited state. Consistent set of values: [20 - 100 $\mu s$]                                                                           |
| Qubit dephasing time (white noise) | $T_{\phi}$               | 60 $\mu s$ | Consistent set of values would be $2 T_1$ or $\infty$ (all white noise dephasing eliminated)                                                                     |
| Decay time                         | $T_2$                    | 30 $\mu s$ | $\frac{1}{T_2} = \frac{1}{T_{\phi}} + \frac{1}{2 T_1}$                                                                                                           |
| Single-qubit gate time             | $T_{g,1Q}$               | 20 ns      |                                                                                                                                                                  |
| Two-qubit gate time                | $T_{g,2Q}$               | 40 ns      |                                                                                                                                                                  |
| Measurement time                   | $\tau_m$                 | 300 ns     |                                                                                                                                                                  |
| Depletion time                     | $\tau_d$                 | 300 ns     | ?                                                                                                                                                                |
| Fast Measurement time              | $\tau_m^{\text{fast}}$   | 100 ns     |                                                                                                                                                                  |
| Fast Depletion time                | $\tau_d^{\text{fast}}$   | 100 ns     | ?                                                                                                                                                                |
| Readout infidelity                 | $\epsilon_{RO}$          | 5e-3       |                                                                                                                                                                  |
| Physical qubit Fidelity            | $\mathcal{F}_{phys} (t)$ | -          | $\mathcal{F}_{phys} (t) = \frac{1}{6}\left(1 + e^{-\frac{t}{T_1}}\right) + \frac{1}{3}\left(1 + e^{-t\left(\frac{1}{2 T_1} + \frac{1}{T_{\phi}}\right)} \right)$ |
| Physical qubit error rate          | $\epsilon_{phys}$        | -          | $\epsilon_{phys} = - \tau_{circuit} \frac{d \mathcal{F}_{phys} (t)}{dt} \textbar_{t=0}=\frac{\tau_{circuit}}{3 T_1}+\frac{\tau_{circuit}}{3 T_{\phi}}$           |
| In-axis rotation error             | $p_{axis}$               | 1e-4       | Decay corresponding to shrinking along the y axis because of the single-qubit gates depolarizing noise                                                           |
| In-plane rotation error            | $p_{plane}$              | 5e-4       | Decay corresponding to shrinking along the x and z axis because of the single-qubit gates depolarizing noise                                                     |
|------------------------------------+--------------------------+------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------|


**** Github repository

Quantumsim can be found as *python library* in its [[https://github.com/quantumsim/quantumsim][github repository]] with instructions to install it and an overview of how to use it.

**** BIB                                                 :ignore:noexport:

bibliography:../thesis_plan.bib
bibliographystyle:plain
