*** Intro                                                          :ignore:

Once we acknowledged the behaviour of the error growth due to the mapping process, it was the time to understand which circuit parameter affects it the most.
In this section we evaluate the behaviour and quality of the mapping metrics.
From the classical ones -- number of SWAPs and depth -- to the ones we proposed -- fidelity, probability of success and Quantum Volume.

*** Fidelity and probability of success correlation                :ignore:

#+BEGIN_EXPORT latex

#+END_EXPORT

**** What we see in the results                                   :ignore:

#+BEGIN_EXPORT latex

#+END_EXPORT

First we analyze the probability of success and fidelity correlation.
As expected, our experiments prove that both metrics are highly correlated in a logarithmic fashion.
We also appreciated the fact that the probability of success is always higher than the fidelity.
This could suggest that the measurement is 'correcting' circuit errors colliding the state in the correct result, instead of the wrong one.
It is a 'good' mistake that results in the expected solution.
Nevertheless, this behaviour could be caused by the fact that our algorithms are deterministic.
Another knowledge we inherited from the results is that the closer the values go to 0 the more chaotic and random the values will get.
And, also, that no matter how error prone is the system, the probability of success and the fidelity will be correlated in a similar fashion.
# While comparing the results with different decoherence times, we noticed that more error prone is your system, the less correlated these two metrics are.

**** What we show in the figure                                   :ignore:

#+BEGIN_EXPORT latex

#+END_EXPORT

In Fig. [[fig:f_ps_correlation_with_meas_error]] we plot the results of the framework in terms of probability of success and fidelity. 
For this figure and the figures from now on in this section, each dot is a different benchmark configuration and the colors represent different decoherence times, blue for 30 $\mu s$ and orange for 10 $\mu s$.
Fig. [[fig:f_ps_correlation_with_meas_error]] highlights a logarithmic correlation as well as the bias between both metrics, proving the fact that the probability of success is always higher than the fidelity.
For instance, for values around 0.6 in fidelity, the probability of success has a value bigger than 0.7 for the majority of the samples.
Note that for values close to 1, fidelity and probability of success tend to be equal and linear, which make sense; if some circuit has almost no error, both metrics will be equally good.
At the same time, the closer the values are to 0, the more spread the samples are, [proving the chaotic behaviour]
It can be seen that the inclination and bias of the fitting line changes depending on the decoherence time of the system.
Showing that, the higher amount of errors in the system, the more diagonal the fitting line gets.
The cluster that appears between the 0.9 and 1.0 values is due to the amount of simple benchmarks in the selection, as we previously mentioned.

#+caption: Correlation between fidelity and probability of success for two different decoherence times
#+NAME: fig:f_ps_correlation_with_meas_error
#+ATTR_LATEX: :width 0.7\textwidth
[[file:figures/f_ps_correlation.eps]]

# In Fig. [[fig:f_ps_correlation_no_meas_error]] we plot the results of the framework with and without introducing errors in the measurement.
# The blue dots are, as in Fig. [[fig:f_ps_correlation_with_meas_error]], the different benchmark configurations simulated with a decoherence time of 30 $\mu s$ and measurement errors.
# On the other hand, this time, the orange dots represent benchmark configurations simulated with a decoherence time of 30 $\mu s$ without measurement errors.
# As we expected, the ... [We are not showing anything in this figure!]

# #+caption: Correlation between fidelity and probability of success for the case of having errors in the measurement and not having errors
# #+NAME: fig:f_ps_correlation_no_meas_error
# #+ATTR_LATEX: :width 0.6\textwidth
# [[file:figures/f_ps_correlation_no_meas_error.png]]


***** With measurement error                                   :noexport:

SIGO FILTRANDO FIDELITY > 0.5

#+BEGIN_SRC c

Analysis For Decoherence Time = 3000 and Error Measurement = 0.005

        -------------------------------

        -- Correlation between the Fidelity and Probability of Success

Polynomial function:

0.5914 x + 0.4081
----------------------------

(0.9192199104316764, 3.767553069709704e-25)

        Analysis For Decoherence Time = 1000 and Error Measurement = 0.005

        -------------------------------

        -- Correlation between the Fidelity and Probability of Success

Polynomial function:

0.7122 x + 0.3026
----------------------------

(0.9560273488297862, 4.0669039495216075e-12)

#+END_SRC


***** No Measurement error                                     :noexport:

SIGO FILTRANDO FIDELITY > 0.5


#+BEGIN_SRC C

Analysis For Decoherence Time = 3000 and Error Measurement = 0.005

        -------------------------------

        -- Correlation between the Fidelity and Probability of Success

Polynomial function:

0.5914 x + 0.4081
----------------------------

(0.9192199104316764, 3.767553069709704e-25)

        Analysis For Decoherence Time = 3000 and Error Measurement = 0

        -------------------------------

        -- Correlation between the Fidelity and Probability of Success

Polynomial function:

0.6267 x + 0.3777
----------------------------

(0.9358217171375378, 1.410870124624645e-26)

#+END_SRC

*** Metrics behaviour                                              :ignore:

#+BEGIN_EXPORT latex

#+END_EXPORT

**** How we analyze it                                            :ignore:

#+BEGIN_EXPORT latex

#+END_EXPORT

We use the Pearson correlation to measure which metric is the most correlated one with fidelity and probability of success.
As it can be seen in the Pearson values (Tab. [REFER TO TAB]) the metric most correlated is the number of two-qubit gates.
These results hold the fact that the quality of the mapping depends on the longitude of the targeted circuit, making crucial the mapping quality for small benchmarks.

**** What we see in the results                                   :ignore:

#+BEGIN_EXPORT latex

#+END_EXPORT

[CORRELATION TABLE]

Quantum's Volume small lack of correlation can be attributed to the imprecise formula that we chose to calculate it.
Given that this was only a preliminary attempt to include the Quantum Volume as mapping metric it is hardly surprising that the results are not directly correlating it with the mapping quality.

**** What we see in the figures                                   :ignore:

The results of the main mapping metrics against fidelity are depicted in Fig. [[ref:fig:f_metrics_correlation][ref:fig:f_metrics_correlation]].
As in previous plots, we show the results for two different decoherence times, 30 $\mu s$ (blue dots) and 10 $\mu s$ (orange dots).
We observe that, for all the cases, the fidelity decreases with an inverse exponential behaviour.

#+caption: Correlation between fidelity and the mapping metrics.
#+NAME: fig:f_metrics_correlation
#+ATTR_LATEX: :width \textwidth
[[file:figures/f_metrics_correlation_poly.eps]]

The correlation between the probability of success and the other metrics can be see in Fig. [[ref:fig:ps_metrics_correlation][ref:fig:ps_metrics_correlation]].
As with the study on fidelity correlation we plot two decoherence times, 30 $\mu s$ (blue) and 10 $\mu s$ (orange).
We also observe a decreasing behaviour, although the shape is not as clear as in the case of fidelity.
This could be provoked by the final error added by the measurement gate and by the fact that, most of the times, the measurement is correcting the wrong solutions.

#+caption: Correlation between probability of success and the mapping metrics.
#+NAME: fig:ps_metrics_correlation
#+ATTR_LATEX: :width \textwidth
[[file:figures/ps_metrics_correlation.eps]]

We can also see in both figures that, as announced before, there is a cluster of benchmarks with high fidelity and high probability of success.
This happens because of the high concentration of small benchmarks, due to the simulation difficulties.
On the contrary, the rest of the values are a bit sparsed.


******  Notes                                                 :noexport:

SIGO FILTRANDO FIDELITY > 0.5

#+BEGIN_SRC C

        Analysis For Decoherence Time = 3000 and Error Measurement = 0.005

        -------------------------------

        -- Correlation between Fidelity and:

- # of Gates:

Polynomial function:
           2
1.534e-07 x - 0.000523 x + 1.005
----------------------------

(-0.8630740403512944, 7.492413733912921e-19)

- # of two-qubit gates:

Polynomial function:
           2
3.049e-06 x - 0.002383 x + 1.004
----------------------------

(-0.863286950097695, 7.18389012251959e-19)

- Depth:

Polynomial function:
           2
3.203e-07 x - 0.0007814 x + 1.019
----------------------------

(-0.8305711564938272, 2.2460770328365885e-16)

- Quantum Volume:

Polynomial function:
           2
4.242e-09 x - 8.926e-05 x + 0.9828
----------------------------

(-0.7902264007122082, 6.045814411414274e-14)


        -- Correlation between Probability of Success and:

- # of Gates:

Polynomial function:
           2
1.425e-07 x - 0.0003704 x + 1.008
----------------------------

(-0.6324404022306189, 5.9408960728175597e-08)

- # of two-qubit gates:

Polynomial function:
           2
2.769e-06 x - 0.001732 x + 1.01
----------------------------

(-0.6441233355408925, 2.8150298712169916e-08)

- Depth:

Polynomial function:
           2
2.584e-07 x - 0.0005238 x + 1.014
----------------------------

(-0.6174470539858588, 1.4818911589874065e-07)

- Quantum Volume:

Polynomial function:
           2
3.169e-09 x - 5.64e-05 x + 0.988
----------------------------

(-0.5724133147384978, 1.7659969011385104e-06)

        Analysis For Decoherence Time = 1000 and Error Measurement = 0.005

        -------------------------------

        -- Correlation between Fidelity and:

- # of Gates:

Polynomial function:
           2
5.383e-07 x - 0.001103 x + 0.9934
----------------------------

(-0.897561920337874, 1.4957448590931355e-08)

- # of two-qubit gates:

Polynomial function:
          2
1.629e-05 x - 0.005348 x + 0.9712
----------------------------

(-0.7785748517752366, 1.975273755557373e-05)

- Depth:

Polynomial function:
           2
1.651e-06 x - 0.001773 x + 1.009
----------------------------

(-0.8194633195943474, 3.078535631273159e-06)

- Quantum Volume:

Polynomial function:
           2
2.687e-08 x - 0.000201 x + 0.9471
----------------------------

(-0.6784205747012305, 0.0005194496207515033)


        -- Correlation between Probability of Success and:

- # of Gates:

Polynomial function:
          2
2.03e-08 x - 0.0006141 x + 0.9941
----------------------------

(-0.8447301986384201, 7.618304513439932e-07)

- # of two-qubit gates:

Polynomial function:
           2
3.226e-06 x - 0.002616 x + 0.9647
----------------------------

(-0.6901152561603443, 0.00037894800783273185)

- Depth:

Polynomial function:
           2
6.506e-07 x - 0.001068 x + 1.009
----------------------------

(-0.792713984206436, 1.0880694258391198e-05)

- Quantum Volume:

Polynomial function:
           2
1.125e-08 x - 0.0001186 x + 0.9648
----------------------------

(-0.6477821957243156, 0.0011155566982108602)


#+END_SRC


*** BIB                                                   :ignore:noexport:

bibliography:../thesis_plan.bib
bibliographystyle:plain
